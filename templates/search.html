{% extends "base.html" %}
{% block content %}

<h1>Búsqueda de Contribuyentes</h1>

<div class="card">
  <form method="GET">
    <label>Buscar por:</label>
    <select name="type">

      rfc = request.form['rfc'].strip().upper()
      nombre = request.form['nombre'].strip().upper()

      <option value="rfc" {% if search_type == 'rfc' %}selected{% endif %}>RFC</option>
      <option value="nombre" {% if search_type == 'nombre' %}selected{% endif %}>Nombre</option>
    </select>

    <input type="text" name="q" value="{{ query }}" placeholder="RFC o nombre" required>
    <button class="btn">Buscar</button>
  </form>
</div>

{% if results %}
<div class="card">
  <h2>Resultados ({{ results_count }})</h2>

  <table>
    <tr>
      <th>RFC</th>
      <th>Nombre</th>
      <th>Tabla</th>
      <th>Número</th>
    </tr>

    {% for r in results %}
    <tr>
      <td>{{ r.rfc }}</td>
      <td>{{ r.nombre_contribuyente }}</td>
      <td>{{ r.tabla_origen }}</td>
      <td>{{ r.numero }}</td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endif %}

{% endblock %}
